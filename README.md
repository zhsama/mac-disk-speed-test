# Mac硬盘速度测试工具

一个用于测试Mac系统硬盘读写速度的Shell脚本工具。

## 功能特性

- 🔍 自动识别Mac下的硬盘挂载情况
- 📊 测试硬盘的读取和写入速度
- 🔄 进行三次测速并计算平均值
- 📏 支持多种测试文件大小（1GB、5GB、10GB）
- 🧹 自动清理测速使用的临时文件
- 🎨 彩色输出，清晰易读
- ⚡ 完全交互式操作，用户友好
- 📝 自动保存测试结果到日志文件

## 系统要求

- macOS系统
- 管理员权限（用于清除系统缓存）
- 足够的磁盘空间（至少是测试文件大小的2倍）

## 安装

1. 下载脚本文件：
```bash
curl -O https://raw.githubusercontent.com/your-repo/mac-disk-speed-test/main/disk_speed_test.sh
```

2. 添加可执行权限：
```bash
chmod +x disk_speed_test.sh
```

## 使用方法

### 交互式使用（推荐）

直接运行脚本，会自动显示当前挂载的硬盘，然后提供交互式选择菜单：

```bash
./disk_speed_test.sh
```

脚本会：
1. 自动扫描并显示当前挂载的所有硬盘
2. 提示您输入硬盘序号来选择要测试的硬盘
3. 提示您输入文件大小序号来选择测试文件大小
4. 开始进行三轮测试
5. 显示测试结果并自动保存到 `logs/` 目录

### 查看帮助

```bash
./disk_speed_test.sh --help
```

## 测试文件大小说明

| 大小 | 说明 | 适用场景 |
|------|------|----------|
| 1GB  | 快速测试 | 快速了解硬盘性能 |
| 5GB  | 标准测试 | 日常性能评估 |
| 10GB | 深度测试 | 专业性能测试 |

## 日志功能

脚本会自动将测试结果保存到 `logs/` 目录下，日志文件命名格式为：
```
disk_test_[硬盘名称]_[文件大小]_[时间戳].log
```

例如：
- `disk_test___1g_20250608_171741.log` - 根目录测试结果
- `disk_test__Volumes_KIOXIA_1g_20250608_171823.log` - 外接硬盘测试结果

日志文件包含：
- 测试时间和基本信息
- 硬盘详细信息（容量、设备、类型等）
- 三轮测试的详细结果
- 平均速度统计

## 输出示例

```
========================================
        Mac硬盘速度测试工具
========================================

[INFO] 正在扫描挂载的硬盘...

可用的硬盘:

 1) /                    [  465Gi] 可用:   89Gi   设备: /dev/disk3s1s1    Media Name: APPLE SSD Protocol: PCI-Express 
 2) /Volumes/USB         [  931Gi] 可用:  500Gi   设备: /dev/disk4s1      Media Name: USB Drive Protocol: USB 

请选择要测试的硬盘 (输入数字): 1
[SUCCESS] 已选择硬盘: /

请选择测试文件大小:

1) 1GB  - 快速测试
2) 5GB  - 标准测试
3) 10GB - 深度测试

请选择 (1-3): 1

[INFO] 开始硬盘速度测试
[INFO] 测试路径: /
[INFO] 文件大小: 1g (1.0GB)

[INFO] 开始进行3轮测试...

=== 第 1 轮测试 ===
[INFO] 开始写入速度测试...
[SUCCESS] 写入速度: 1250.45 MB/s
[INFO] 开始读取速度测试...
[SUCCESS] 读取速度: 2100.32 MB/s

=== 第 2 轮测试 ===
[INFO] 开始写入速度测试...
[SUCCESS] 写入速度: 1245.67 MB/s
[INFO] 开始读取速度测试...
[SUCCESS] 读取速度: 2095.78 MB/s

=== 第 3 轮测试 ===
[INFO] 开始写入速度测试...
[SUCCESS] 写入速度: 1248.91 MB/s
[INFO] 开始读取速度测试...
[SUCCESS] 读取速度: 2098.55 MB/s

========================================
[SUCCESS] 测试完成！
========================================

测试硬盘       : /
测试文件大小   : 1g

详细结果:
第1轮 - 写入:  1250.45 MB/s  读取:  2100.32 MB/s
第2轮 - 写入:  1245.67 MB/s  读取:  2095.78 MB/s
第3轮 - 写入:  1248.91 MB/s  读取:  2098.55 MB/s

平均速度 - 写入:  1248.34 MB/s  读取:  2098.22 MB/s
========================================
```

## 注意事项

1. **管理员权限**: 脚本需要管理员权限来清除系统缓存，确保测试结果准确
2. **磁盘空间**: 确保目标硬盘有足够的可用空间（至少是测试文件大小的2倍）
3. **测试时间**: 大文件测试可能需要较长时间，请耐心等待
4. **系统负载**: 建议在系统负载较低时进行测试，以获得更准确的结果
5. **外接硬盘**: 测试外接硬盘时，确保连接稳定

## 故障排除

### 权限问题
如果遇到权限错误，请使用 `sudo` 运行：
```bash
sudo ./disk_speed_test.sh
```

### 磁盘空间不足
如果提示磁盘空间不足，请：
1. 清理目标硬盘的空间
2. 选择较小的测试文件大小

### 命令不存在
如果提示缺少必要命令，请确保系统已安装：
- `df` - 磁盘空间查看工具
- `diskutil` - macOS磁盘工具
- `dd` - 数据复制工具
- `bc` - 计算器工具

## 技术原理

脚本使用以下技术来测试硬盘速度：

1. **写入测试**: 使用 `dd` 命令从 `/dev/zero` 写入指定大小的数据到测试文件
2. **读取测试**: 使用 `dd` 命令从测试文件读取数据到 `/dev/null`
3. **缓存清理**: 使用 `purge` 命令清除系统缓存，确保测试准确性
4. **时间测量**: 使用高精度时间戳计算传输速度
5. **多轮测试**: 进行3轮测试并计算平均值，减少测试误差

## 许可证

MIT License

## 贡献

欢迎提交Issue和Pull Request来改进这个工具！
